---
title: "ggplot Grouped Bar Chart"
author: "Devlin Moyer"
date: "13 11 2019"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}
library(tidyverse)
```

```{r}
# all of the normal input functions were being pissy about the bitstrings
data <- readChar("data/ab_6_2ins_5outs_1000reps.csv", nchars = 26852) %>%
  strsplit("\n") %>%
  as.data.frame(.) %>%
  rename(mess = 1) %>%
  separate(mess, sep = ",", into = c(
    "row", "bitstring", "occurrences", "rxn_count")
  ) %>%
  select(-row) %>%
  mutate(bitstring = as.factor(bitstring)) %>%
  mutate(rxn_count = as.numeric(rxn_count)) %>%
  mutate(occurrences = as.numeric(occurrences))

# trying to filter out the first row was also being weird
data <- data[-1,]
```

```{r fig.width=10}
ggplot(data, aes(x = rxn_count, y = occurrences)) + 
  geom_bar(position = "dodge", stat = "identity", aes(fill = bitstring)) +
  theme_bw() + theme(legend.position = "none") +
  labs(
    x = "Number of Reactions", 
    y = "Number of Times Network Was Observed", 
    title = "Results of 1000 Random Prunes"
)
```